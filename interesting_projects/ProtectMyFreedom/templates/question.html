{% extends 'base.html' %}

{% block title %}{{ question.title }}{% endblock %}

{% block content %}

    {% include 'nav.html' %}

    <div class="question container">

        <div class="question__data">
            <h3>{{ question.title }}</h3>

            <pre>Author: <span>{{ question.author.username }}</span>    Date of publication: <span>{{ question.date.strftime('%d.%m.%Y %H:%M') }}</span></pre>

            <p>{{ question.question }}</p>

            {% if like %}
                <div id="carouselExampleIndicators" class="carousel slide" data-ride="carousel">
                    <ol class="carousel-indicators">
                        <li data-target="#carouselExampleIndicators" data-slide-to="0" class="active"></li>
                        <li data-target="#carouselExampleIndicators" data-slide-to="1"></li>
                        <li data-target="#carouselExampleIndicators" data-slide-to="2"></li>
                    </ol>
                    <div class="carousel-inner">
                        <div class="carousel-item active">
                            <img class="d-block w-100" src="https://placeimg.com/1080/500/nature" alt="First slide">
                        </div>
                        <div class="carousel-item">
                            <img class="d-block w-100" src="https://placeimg.com/1080/500/nature" alt="Second slide">
                        </div>
                        <div class="carousel-item">
                            <img class="d-block w-100" src="https://placeimg.com/1080/500/nature" alt="Third slide">
                        </div>
                    </div>
                    <a class="carousel-control-prev" href="#carouselExampleIndicators" role="button" data-slide="prev">
                        <span class="carousel-control-prev-icon" aria-hidden="true"></span>
                        <span class="sr-only">Previous</span>
                    </a>
                    <a class="carousel-control-next" href="#carouselExampleIndicators" role="button" data-slide="next">
                        <span class="carousel-control-next-icon" aria-hidden="true"></span>
                        <span class="sr-only">Next</span>
                    </a>
                </div>
            {% endif %}

            <br>

            {% for qt in question.question_obj %}
                <a href="/tag/{{ qt.tag.id }}" class="btn btn-secondary btn-sm">{{ qt.tag.tag }}</a>
            {% endfor %}

            {% if question.author.id != session["id"] %}
                {% if like %}
                    <a href="/question/{{ question.id }}/like" class="btn btn-light">üß° {{ likes }}</a>
                {% else %}
                    <a href="/question/{{ question.id }}/like" class="btn btn-light">ü§ç {{ likes }}</a>
                {% endif %}
            {% else %}
                <a class="btn btn-light">ü§ç {{ likes }}</a>
            {% endif %}
        </div>

        <div class="question__other">
            <div>
                <h4>Other questions:</h4>
                
                <ul>
                    {% for question in other_questions %}
                        <li><a href="/question/{{ question.id }}" class="text-decoration-none">{{ question.title }}</a></li>
                    {% endfor %}
                </ul>
            </div>
        </div>

        <div class="question__answers">
            <h5>Answers ({{ question.question_answer_obj|length }}):</h5>

            <form action="/question/answer" method="POST">
                <textarea class="form-control" name="answer" placeholder="Make your answer" required></textarea>
                <input type="hidden" name="question_id" value="{{ question.id }}">
                <br>
                <input type="submit" value="Post your answer">
            </form>


            <div>

                {% for q in popular_answers %}
                    <div class="question__answers__item">
                        <hr>
                        <p>{{ q.text }}</p>
                        <p>{{ q.author.username }} | {{ q.date }} <span class="green">New</span></p>
                    </div>
                {% endfor %}

                {% for q in new_answers %}
                    <div class="question__answers__item">
                        <hr>
                        <p>{{ q.text }}</p>

                        <div class="flex">
                            {% if q.author.user_avatar %}
                                <div>
                                    <a href="/profile/{{ q.author.id }}">
                                        <div class="avatar_little" style="background-image: url('../../{{ q.author.user_avatar[0].path }}')"></div> 
                                    </a>
                                </div>
                            {% else %}
                                <div>
                                    <a href="/profile/{{ q.author.id }}">
                                        <div class="avatar_little"></div>
                                    </a>
                                </div>
                            {% endif %}
                            <div class="text-secondary">&nbsp;&nbsp;
                                <a href="/profile/{{ q.author.id }}" class="text-decoration-none text-secondary">{{ q.author.username }}</a>
                            &nbsp;&nbsp;&nbsp;|&nbsp;&nbsp;&nbsp;{{ q.date }}&nbsp;&nbsp;&nbsp;
                            <span class="green">New</span></div>
                        </div>
                    </div>
                {% endfor %}

                {% if question.question_answer_obj|length > 7 %}
                    <hr>
                    <p><a href="/question/answers/{{ question.id }}" class="text-decoration-none">See all answers</a></p>
                {% endif %}

            </div>
            <hr>

            <div class="question__answer__footer">
                <p><a href="/ask" class="text-decoration-none">Ask your own question</a></p>
            </div>
        </div>

    </div>

    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/css/bootstrap.min.css" integrity="sha384-Gn5384xqQ1aoWXA+058RXPxPg6fy4IWvTNh0E263XmFcJlSAwiGgFAW/dAiS6JXm" crossorigin="anonymous">
    <script src="https://code.jquery.com/jquery-3.2.1.slim.min.js" integrity="sha384-KJ3o2DKtIkvYIK3UENzmM7KCkRr/rE9/Qpg6aAZGJwFDMVNA/GpGFF93hXpG5KkN" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.12.9/umd/popper.min.js" integrity="sha384-ApNbgh9B+Y1QKtv3Rn7W3mgPxhU9K/ScQsAP7hUibX39j7fakFPskvXusvfa0b4Q" crossorigin="anonymous"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/js/bootstrap.min.js" integrity="sha384-JZR6Spejh4U02d8jOt6vLEHfe/JQGiRRSQQxSfFWpi1MquVdAyjUar5+76PVCmYl" crossorigin="anonymous"></script>

    {% include 'footer.html' %}

{% endblock %}